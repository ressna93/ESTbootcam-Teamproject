# 장바구니 페이지 (Cart Page)

## 개요

사용자가 선택한 상품을 확인하고 주문을 진행할 수 있는 장바구니 페이지입니다.

## 주요 기능

### 1. 장바구니 데이터 로드

- **API 연동**: `GET /cart/` 엔드포인트를 통해 장바구니 데이터를 가져옵니다
- **상품 정보 가져오기**: 각 장바구니 아이템에 대해 `GET /products/{id}`로 상세 정보를 조회합니다
- **인증**: localStorage의 `access_token`을 Authorization 헤더에 포함하여 전송합니다
- **로딩 상태**: 데이터 로드 중 로딩 메시지를 표시합니다
- **에러 처리**: API 호출 실패 시 사용자에게 에러 메시지와 새로고침 버튼을 표시합니다

### 2. 장바구니 UI

- **빈 장바구니**: 상품이 없을 때 안내 메시지를 표시합니다
- **상품 카드**: 각 상품의 이미지, 이름, 가격, 수량, 옵션 정보를 표시합니다
- **체크박스**: 주문할 상품을 선택할 수 있습니다
- **주문 단계**: 상품정보 → 수령 → 상품결제 단계를 시각적으로 표시합니다

### 3. 수량 관리

- **수량 조절**: +/- 버튼 또는 직접 입력으로 수량을 변경할 수 있습니다
- **수량 변경 모달**: 수량 변경 시 모달을 통해 확인합니다
- **API 업데이트**: `PUT /cart/{id}/` 엔드포인트로 수량을 서버에 동기화합니다
- **유효성 검사**: 최소 수량 1개 이상을 보장합니다

### 4. 상품 삭제

- **삭제 버튼**: 각 상품 카드에 X 버튼이 있습니다
- **삭제 확인 모달**: 삭제 전 확인 메시지를 표시합니다
- **API 호출**: `DELETE /cart/{id}/` 엔드포인트로 상품을 삭제합니다

### 5. 주문 금액 계산

- **총 상품금액**: 체크된 상품들의 가격 × 수량을 합산합니다
- **상품 할인**: 현재는 0원으로 설정되어 있습니다
- **배송비**: 현재는 0원으로 설정되어 있습니다
- **결제 예정 금액**: 총 상품금액 - 할인 + 배송비를 계산합니다
- **실시간 업데이트**: 체크박스 변경 또는 수량 변경 시 즉시 반영됩니다

### 6. 주문하기

- **개별 주문**: 각 상품의 "주문하기" 버튼으로 해당 상품만 주문할 수 있습니다
- **전체 주문**: 하단의 "주문하기" 버튼으로 체크된 모든 상품을 주문할 수 있습니다
- **로그인 확인**: 로그인이 필요한 경우 로그인 모달을 표시합니다
- **주문 데이터 저장**: localStorage에 주문 정보를 저장하고 주문 페이지로 이동합니다

### 7. 모달 시스템

#### 수량 선택 모달

- 수량 입력 및 +/- 버튼 제공
- Enter 키로 수정 완료 가능
- 취소 및 수정 버튼 제공

#### 삭제 확인 모달

- 상품명과 함께 삭제 확인 메시지 표시
- 예/아니오 선택 가능

#### 로그인 요청 모달

- 로그인이 필요한 경우 표시
- "예" 선택 시 로그인 페이지로 이동 (redirect 파라미터 포함)
- "아니오" 선택 시 비회원 주문 진행

## 파일 구조

```
web/pages/cart/
├── cart.html          # 페이지 HTML 구조
├── cart.js            # 장바구니 로직 및 API 연동
└── cart.md            # 발표용 정리 문서 (이 파일)
```

## 관련 파일

```
web/
├── styles/
│   └── cart.css       # 장바구니 페이지 스타일
├── components/
│   └── layout.js      # 공통 헤더/푸터 레이아웃
└── pages/
    ├── cart/
    │   ├── cart.html
    │   ├── cart.js
    │   └── cart.md
    └── order/
        └── order.html  # 주문 페이지 (이동 대상)
```

## 사용 기술

- **Vanilla JavaScript**: 프레임워크 없이 순수 JavaScript 사용
- **Fetch API**: REST API 통신
- **LocalStorage**: 인증 토큰 및 주문 데이터 저장
- **Async/Await**: 비동기 처리
- **DOM Manipulation**: 동적 UI 렌더링

## API 엔드포인트

| 메소드 | 엔드포인트       | 설명                   |
| ------ | ---------------- | ---------------------- |
| GET    | `/cart/`         | 장바구니 목록 조회     |
| GET    | `/products/{id}` | 상품 상세 정보 조회    |
| PUT    | `/cart/{id}/`    | 장바구니 수량 업데이트 |
| DELETE | `/cart/{id}/`    | 장바구니 아이템 삭제   |

## 주요 함수

### 데이터 관리

- `fetchCartItems()`: 장바구니 데이터를 API에서 가져옵니다
- `updateCartItemQuantity(cartItemId, newQuantity)`: 수량을 업데이트합니다
- `deleteCartItem(cartItemId)`: 장바구니 아이템을 삭제합니다

### UI 렌더링

- `renderCart()`: 장바구니 전체 UI를 렌더링합니다
- `createProductCard(item, index)`: 개별 상품 카드를 생성합니다
- `updateOrderSummary()`: 주문 금액을 계산하고 업데이트합니다

### 모달 관리

- `openModal(modalId, item)`: 모달을 엽니다
- `closeModal(modal)`: 모달을 닫습니다
- `initModalEventListeners()`: 모달 이벤트 리스너를 초기화합니다

### 유틸리티

- `formatPrice(price)`: 가격을 천 단위 콤마 형식으로 변환합니다
- `isUserLoggedIn()`: 로그인 상태를 확인합니다
- `goToOrderPage(orderItems)`: 주문 페이지로 이동합니다

## 사용자 경험 (UX)

- **반응형 디자인**: 다양한 화면 크기에 대응합니다
- **실시간 피드백**: 수량 변경, 삭제 등의 작업에 즉시 반응합니다
- **명확한 안내**: 빈 장바구니, 로딩, 에러 상태를 명확히 표시합니다
- **모달 확인**: 중요한 작업(삭제, 수량 변경)에 확인 단계를 제공합니다
- **배경 스크롤 방지**: 모달 열림 시 배경 스크롤을 차단합니다

## 개선 가능한 부분

- 할인 및 배송비 계산 로직 구현
- 상품 옵션 변경 기능 추가
- 장바구니 전체 선택/해제 기능
- 찜하기 기능 추가
- 최근 본 상품 추천
